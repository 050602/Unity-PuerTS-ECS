{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./Script/core/BaseView.ts","webpack:///./Script/core/GameConst.ts","webpack:///./Script/core/ObjectPool.ts","webpack:///./Script/core/Sigleton.ts","webpack:///./Script/core/TimerTS.ts","webpack:///./Script/core/UIManager.ts","webpack:///./Script/core/ViewConst.ts","webpack:///./Script/core/ecs/base/ECSComponent.ts","webpack:///./Script/core/ecs/base/ECSEntity.ts","webpack:///./Script/core/ecs/base/ECSManager.ts","webpack:///./Script/event/TSEventCenter.ts","webpack:///./Script/event/ViewEvent.ts","webpack:///./Script/fight/Com/RoleCom.ts","webpack:///./Script/fight/Com/VoCom.ts","webpack:///./Script/fight/World.ts","webpack:///./Script/utils/LogTS.ts","webpack:///./Script/view/MainUIView/MainUIBinder.ts","webpack:///./Script/view/MainUIView/MainUIView.ts","webpack:///./Script/view/TSMain.ts","webpack:///external \"csharp\"","webpack:///external \"puerts\""],"names":[],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./Script/view/TSMain.ts\");\n","import { FairyGUI, System, EventCenter, Log } from \"csharp\";\r\nimport { UIManager } from \"./UIManager\";\r\n\r\n\r\nexport class BaseView extends FairyGUI.GComponent {\r\n\r\n    public uiId: string\r\n\r\n    public bindKeys: System.Collections.Generic.List$1<string>;\r\n\r\n    public onInit(){}\r\n\r\n    public onOpen(args: any = null) {\r\n        Log.log(\"onOpen:\" + this.uiId);\r\n\r\n    }\r\n\r\n    public onClose() {\r\n\r\n    }\r\n\r\n    public onDestroy() {\r\n        if (this.bindKeys != null) {\r\n            this.bindKeys = null;\r\n        }\r\n\r\n\r\n    }\r\n\r\n    public close() {\r\n        UIManager.getInstance().closeView(this.uiId);\r\n    }\r\n\r\n}","var frameRate: number = 60;\r\nexport const GameUpdateCD: number = 0.03;\r\n\r\n//普通属性\r\nexport enum Attr {\r\n    MoveSpeed = 1,\r\n    AttackSpeed,\r\n    Attack,\r\n    AttackRange,\r\n    Hp,\r\n    MaxHp,\r\n    FlySpeed = 7,//投射物飞行速度增益\r\n    FlySpeedPercent = 8,//投射物飞行速度增益 万分比\r\n}\r\n\r\n//特殊属性\r\nexport enum AttrVar {\r\n\r\n    ProjectilesMultipleCasting = 10001,//投射物多重施法概率 万分比属性  触发投射物时，会分裂出新的投射物\r\n    ProjectilesAddNumber = 10002,//投射物多重施法增加的投射物个数，默认1个\r\n\r\n}","\r\n/**\r\n* 对象池\r\n* @author An\r\n*/\r\n\r\nexport interface ObjectPoolIT {\r\n    recycleToObjectPool: Function\r\n}\r\n\r\nexport class ObjectPool {\r\n    private static pool: Map<string, any[]> = new Map<string, any[]>();\r\n    private static useCount: number = 0;//new过的对象数量\r\n    private static reCount: number = 0;//回收过的对象数量\r\n    private static reUsrCount: number = 0;//重新被使用的对象数量\r\n\r\n    /**\r\n     * 指定类名及类型 获取一个对象\r\n     * @param className 类名\r\n     * @param T 类型\r\n     */\r\n    public static getObjectByClass(className: string, T: any): any {\r\n        let arr = ObjectPool.pool.get(className);\r\n        if (!arr || !arr.length) {\r\n            let t = new T();\r\n            this.useCount++;\r\n            // gzalog(className,\"new的对象数量\",this.useCount);\r\n            return t;\r\n        }\r\n\r\n        let t = arr.shift();\r\n        this.reUsrCount++;\r\n        return t;\r\n    }\r\n\r\n    /**\r\n     * 指定类名 获取一个对象 若没有该类名的对象，返回Null\r\n     * @param className 类名\r\n     * @param T 类型\r\n     */\r\n    public static getObject(className: string): any {\r\n        let arr = ObjectPool.pool.get(className);\r\n        if (!arr || !arr.length) {\r\n            return null;\r\n        }\r\n\r\n        let t = arr.shift();\r\n        this.reUsrCount++;\r\n        return t;\r\n    }\r\n\r\n    public static getPoolLength(className: string): number {\r\n        let arr = ObjectPool.pool.get(className);\r\n        return arr.length;\r\n    }\r\n\r\n    /**\r\n     * 把对象回收到对象池，如果被回收的对象有recoverToObjcetPool方法，会自动调用该方法，可以在该方法里进行重置操作\r\n     * @param className 类名\r\n     * @param obj 要回收的对象\r\n     */\r\n    public static recover(className: string, obj: any): void {\r\n        let arr = ObjectPool.pool.get(className);\r\n        if (!arr) {\r\n            arr = [];\r\n        }\r\n\r\n        if (obj.recycleToObjectPool) {\r\n            obj.recycleToObjectPool();\r\n        }\r\n\r\n        arr.push(obj);\r\n        this.reCount++;\r\n        this.pool.set(className, arr);\r\n    }\r\n\r\n    /**\r\n     * 清空指定对象池\r\n     * @param className \r\n     */\r\n    public static clearPool(className: string): void {\r\n        ObjectPool.pool.delete(className);\r\n        // ObjectPool.checkAllObject();\r\n    }\r\n\r\n    public static checkAllObject(): void {\r\n        // gzalog(\"===================对象池内对象================\");\r\n        // ObjectPool.pool.forEach((value: any[], key: string) => {\r\n        //     gzalog(key + \":\" + value.length);\r\n        // });\r\n\r\n        // gzalog(\"new过的对象数量\" + ObjectPool.useCount);\r\n        // gzalog(\"回收过的对象数量\" + ObjectPool.reCount);\r\n        // gzalog(\"重新被使用的对象数\" + ObjectPool.reUsrCount);\r\n        // gzalog(\"===================对象池数据end================\");\r\n    }\r\n\r\n}","\r\nexport abstract class Sigleton {\r\n    constructor() {\r\n    }\r\n\r\n    public initInstance() { };\r\n    public destoryInstance() { };\r\n    static getInstance(T: any) {\r\n        if (T.instance == null) {\r\n            T.instance = new T();\r\n            T.instance.initInstance();\r\n        }\r\n        return T.instance;\r\n    }\r\n\r\n}","import { Sigleton } from \"./Sigleton\"\r\nimport { Log, EventCenter, TSEvent, System, TSMain } from \"csharp\";\r\nimport { gzaLog } from \"../utils/LogTS\";\r\nimport { GameUpdateCD } from \"./GameConst\";\r\n\r\nexport interface TimerObj {\r\n    callback: Function; // 回调\r\n    thisObj: any;        // 目标 上下文\r\n    interval: number;   // 间隔\r\n    repeat: number;     // 重复次数\r\n    accTime: number;    // 累计时长\r\n    delay: number;      // 延迟\r\n    uid: number;//唯一ID\r\n}\r\n\r\n\r\nexport class TimerTS extends Sigleton {\r\n\r\n    static getInstance(): TimerTS {\r\n        return super.getInstance(TimerTS);\r\n    }\r\n\r\n    public initInstance() {\r\n        EventCenter.Instance.bind(TSEvent.TICK, this, this.update);\r\n    }\r\n\r\n    private static _isRunning: boolean = false;\r\n    private static _arr: TimerObj[] = [];\r\n    private static _pause: boolean = false;//是否暂停\r\n\r\n    private uid: number = 1;\r\n\r\n    //获取唯一ID\r\n    public getUID(): number {\r\n        return this.uid++;\r\n    }\r\n\r\n\r\n    public update(systobj: System.Object, args: System.Array$1<System.Object>) {\r\n        // let dt: any = args.get_Item(0);\r\n        if (TimerTS._pause) return;\r\n\r\n        //隔0.1秒执行一次 执行3次\r\n        let arr = TimerTS._arr;\r\n        for (let i = 0; i < arr.length; i++) {\r\n            let dt: number = GameUpdateCD;\r\n            // let dt: any = args.get_Item(0);\r\n            let obj: TimerObj = arr[i];\r\n\r\n            obj.accTime += dt;  //0+0.033 +0.033 = 0.066 +0.033 = 0.1\r\n\r\n            if (obj.delay) {\r\n                let delay = obj.delay;\r\n                //有延时 \r\n                if (obj.accTime >= delay) {\r\n                    obj.accTime = 0;\r\n                    obj.delay = 0;\r\n                }\r\n            } else {\r\n                let func: Function = obj.callback;\r\n                let thisObj: any = obj.thisObj;\r\n                let interval: number = obj.interval;\r\n\r\n                if (obj.accTime >= interval) {    //0.033> 0.1? 0.066>0.1? 0.1>=0.1\r\n                    obj.accTime -= interval;\r\n                    if (interval != 0) {\r\n                        dt = interval;\r\n                    }\r\n                    if (obj.repeat > 0) {        //3 2 1\r\n                        obj.repeat--;            //2 1 0\r\n                        func.apply(thisObj, [dt]);     //执行一次 2 3\r\n                        if (obj.repeat == 0) {   //第三次时，等于0\r\n                            arr.splice(i, 1);   //被销毁\r\n                            i--;\r\n                        }\r\n                    } else {\r\n                        func.apply(thisObj, [dt]);\r\n                    }\r\n                }\r\n\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    /**\r\n     *  监听后不会马上触发，直到经过一次间隔, 除非runNow为true\r\n        如果回调函数已调度，那么将不会重复调度它，只会更新时间间隔参数。=== 即不能重复注册同一个对象 同一个方法\r\n        @param thisObj 方法对应的对象 \r\n        @param callback 每次触发的回调方法 回调参数 dt：number 单位秒\r\n        @param interval 间隔多少秒. 0 则每帧调用 最低间隔为0.016秒 1秒/60帧  如果间隔1秒，延迟2秒，那么方法将会在第3秒时执行\r\n        @param repeat 重复次数, 0为永久重复执行 非0时，会自动解绑\r\n        @param runNow 是否立即执行一次？ 立刻执行不影响重复次数和delay，即 不会减少重复次数\r\n        @param delay 延迟多少秒执行逻辑，如果 间隔1秒，延迟2秒，那么方法将会在第3秒时执行\r\n    */\r\n    public loop(thisObj: any, callback: Function, interval: number = 0, repeat: number = 0, runNow: boolean = false, delay?: number): TimerObj {\r\n        for (let i = 0; i < TimerTS._arr.length; i++) {\r\n            if (TimerTS._arr[i].thisObj == thisObj && TimerTS._arr[i].callback == callback) {\r\n\r\n                Log.logWarning(\"重复注册定时器\");\r\n                return;\r\n            }\r\n        }\r\n\r\n        if (!TimerTS._isRunning) {\r\n            TimerTS._isRunning = true;\r\n            TSMain.Instance.startRunTime();\r\n        }\r\n\r\n        let obj: TimerObj = {\r\n            callback: callback,\r\n            thisObj: thisObj,\r\n            interval: interval,\r\n            repeat: repeat,\r\n            accTime: 0,\r\n            delay: delay,\r\n            uid: this.getUID()\r\n        };\r\n\r\n        if (runNow) {\r\n            callback.apply(thisObj, [0]);\r\n        }\r\n\r\n        TimerTS._arr.push(obj);\r\n\r\n        return obj;\r\n    }\r\n\r\n    /**\r\n  * 清理监听\r\n  * @param callback \r\n  * @param thisObj \r\n  */\r\n    public clear(thisObj: any, callback: Function): void {\r\n        let arr = TimerTS._arr;\r\n        for (let n = 0; n < arr.length; n++) {\r\n            let obj: TimerObj = arr[n];\r\n            if (obj.callback == callback && obj.thisObj == thisObj) {\r\n                arr.splice(n, 1);\r\n                // n--;\r\n                return;\r\n            }\r\n        }\r\n        TimerTS.checkStop();\r\n    }\r\n\r\n    /**\r\n     * 执行一次的计时器\r\n     * @param callback 每次触发的回调方法 回调参数 dt：number 单位秒\r\n     * @param thisObj 方法对应的对象\r\n     * @param delay 延迟多久触发 单位秒\r\n     */\r\n    public once(thisObj: any, callback: Function, delay: number): TimerObj {\r\n        return this.loop(thisObj, callback, delay, 1);\r\n    }\r\n\r\n    //当前是否暂停\r\n    public get pause(): boolean {\r\n        return TimerTS._pause;\r\n    }\r\n\r\n    //设置暂停\r\n    public set pause(_pause) {\r\n        TimerTS._pause = _pause;\r\n    }\r\n\r\n\r\n    public static checkStop() {\r\n        if (!TimerTS._arr.length) {\r\n            TSMain.Instance.stopRunTime();\r\n            TimerTS._isRunning = false;\r\n        }\r\n\r\n    }\r\n\r\n}","import { Sigleton } from \"./Sigleton\";\r\nimport { FairyGUI, EventCenter, Log, System, AddressablesMgr, Timer, UnityEngine } from \"csharp\";\r\nimport { BaseView } from \"./BaseView\";\r\nimport { $promise, $ref, $typeof, $unref } from \"puerts\";\r\nimport { ViewConst } from \"./ViewConst\";\r\nimport { ViewEvent } from \"../event/ViewEvent\";\r\nimport { TSEvent } from \"csharp\";\r\nimport { TSEventCenter } from \"../event/TSEventCenter\";\r\nimport { gzaLog } from \"../utils/LogTS\";\r\nimport { ObjectPool } from \"./ObjectPool\";\r\nimport { TimerTS } from \"./TimerTS\";\r\nimport { World } from \"../fight/World\";\r\n\r\nexport enum UILayer {\r\n    Background = 0,\r\n    Main,//主界面\r\n    Module,//功能UI 装备 神器\r\n    Pop,//弹出窗口\r\n    Fight,//战斗实体，显示飘字之类\r\n    FightUI,//战斗内所有界面\r\n    Tips,//提示\r\n    Top,//顶层\r\n    Loading,//加载层\r\n    Cmd,//GM指令界面\r\n    Toast,\r\n}\r\n\r\nclass UIInfo {\r\n\r\n    public uiId: string;\r\n    public layer: UILayer;\r\n    public cache: boolean;\r\n\r\n    public isClose: boolean;\r\n    public isOpening: boolean;\r\n    public isTsView: boolean;\r\n    public args1: any;\r\n\r\n    constructor(uiId: string, layer: UILayer, cache: boolean, args1: any = null, isTsView: boolean = false, isOpening: boolean = true, isClose: boolean = false) {\r\n        this.uiId = uiId;\r\n        this.layer = layer;\r\n        this.cache = cache;\r\n        this.isClose = isClose;\r\n        this.isOpening = isOpening;\r\n        this.isTsView = isTsView;\r\n        this.args1 = args1;\r\n    }\r\n\r\n}\r\n\r\nexport class UIManager extends Sigleton {\r\n    static getInstance(): UIManager {\r\n        return super.getInstance(UIManager);\r\n    }\r\n\r\n\r\n    public initInstance() {\r\n\r\n        for (let key in UILayer) {\r\n            let keyToAny: any = key;\r\n            if (isNaN(keyToAny)) {\r\n\r\n                let typeNum: any = UILayer[key];\r\n                let layerName: UILayer = typeNum;\r\n                let gc = new FairyGUI.GComponent();\r\n                gc.name = layerName.toString();\r\n                gc.gameObjectName = layerName.toString();\r\n                gc.width = FairyGUI.GRoot.inst.width;\r\n                gc.height = FairyGUI.GRoot.inst.height;\r\n                gc.AddRelation(FairyGUI.GRoot.inst, FairyGUI.RelationType.Width);\r\n                gc.AddRelation(FairyGUI.GRoot.inst, FairyGUI.RelationType.Height);\r\n                gc.MakeFullScreen();\r\n                FairyGUI.GRoot.inst.AddChild(gc);\r\n\r\n                this.layerDic.set(layerName, gc);\r\n            }\r\n        }\r\n\r\n        //把摇杆移动到指定层级  移动到太前的位置，会导致碰不到UI，暂时先不实现吧\r\n        // for (let i = 0; i < FairyGUI.GRoot.inst.GetChildren().Length; i++) {\r\n        //     let joy = FairyGUI.GRoot.inst.GetChildren().get_Item(i);\r\n        //     if(joy.gameObjectName == \"Joy\"){\r\n        //         this.layerDic.get(UILayer.Tips).AddChild(joy);\r\n        //         break;\r\n        //     }\r\n        // }\r\n\r\n\r\n        this.layerDic.get(UILayer.Fight).fairyBatching = true;\r\n        this.layerDic.get(UILayer.FightUI).fairyBatching = true;\r\n\r\n        this.initLoading();\r\n\r\n        // TSEventCenter.getInstance().bind(FightEvent.FLOAT_TEXT, this, this.floatText);\r\n        // TSEventCenter.getInstance().bind(FightEvent.FLOAT_TEXT_NORAML, this, this.floatTextNormal);\r\n\r\n    }\r\n\r\n    private async initLoading() {\r\n        await this.addPackage(\"Loading\");\r\n        this.loading = FairyGUI.UIPackage.CreateObject(\"Loading\", \"LoadingView\").asCom;\r\n        this.layerDic.get(UILayer.Loading).AddChild(this.loading);\r\n\r\n        this.loading.x = (FairyGUI.GRoot.inst.width - this.loading.width) * 0.5;\r\n        this.loading.y = (FairyGUI.GRoot.inst.height - this.loading.height) * 0.5;\r\n        this.loading.visible = false;\r\n    }\r\n\r\n    public dic: Map<string, UIInfo> = new Map();//key是uiid\r\n    public viewCacheDic: Map<string, BaseView> = new Map<string, BaseView>();//key是uiid\r\n\r\n    public layerDic: Map<UILayer, FairyGUI.GComponent> = new Map<UILayer, FairyGUI.GComponent>();\r\n    public packageCache: string[] = [];\r\n\r\n    public stackList: string[] = [];\r\n\r\n    public loadingList: string[] = [];\r\n\r\n    public loading: FairyGUI.GComponent;\r\n\r\n    // public viewCacheDic: Map<string, TSBaseView>;\r\n\r\n\r\n    public getLayerByUILayer(layer: UILayer): FairyGUI.GComponent {\r\n        var gcom = this.layerDic.get(layer)\r\n        return gcom;\r\n    }\r\n\r\n\r\n    public showLoading(dt: number) {\r\n\r\n        if (this.loadingList.length > 0) {\r\n            this.loading.visible = true;\r\n        }\r\n        else {\r\n            this.loading.visible = false;\r\n            TimerTS.getInstance().clear(this, this.showLoading);\r\n        }\r\n    }\r\n\r\n\r\n    public setLoading(uiId: string) {\r\n        if (!this.loading) {\r\n            return;\r\n        }\r\n\r\n        let index = this.loadingList.indexOf(uiId);\r\n        if (index != -1) {\r\n            Log.logWarning(\"指定界面已经进入Loading:\" + uiId);\r\n            return;\r\n        }\r\n\r\n        this.loadingList.push(uiId);\r\n        TimerTS.getInstance().once(this, this.showLoading, 0.35);\r\n\r\n\r\n    }\r\n\r\n\r\n    public clearLoading(uiId: string) {\r\n\r\n        let index = this.loadingList.indexOf(uiId);\r\n        this.loadingList.splice(index, 1);\r\n\r\n        if (this.loadingList.length == 0) {\r\n            this.loading.visible = false;\r\n            TimerTS.getInstance().clear(this, this.showLoading);\r\n        }\r\n    }\r\n\r\n    /**\r\n    *@param name 包名\r\n    */\r\n    public async addPackage(name: string) {\r\n        if (this.packageCache.indexOf(name) != -1) {\r\n            return true;\r\n        }\r\n\r\n        var path = \"Assets/Assets/UI/\" + name + \"_fui.bytes\";\r\n        if (AddressablesMgr.Instance.getFGUIAsset(path) == null) {\r\n            let task = AddressablesMgr.Instance.loadFGUITextAsset(path);\r\n            await $promise(task);\r\n            // int[] png;\r\n            var len = ViewConst.pngStrDic.get(name);\r\n            if (len) {\r\n                let task2 = AddressablesMgr.Instance.loadFGUITexture(\"Assets/Assets/UI/\" + name + \"_atlas0.png\");\r\n                await $promise(task2);\r\n                for (var i = 1; i < len; i++) {\r\n                    let task3 = AddressablesMgr.Instance.loadFGUITexture(\"Assets/Assets/UI/\" + name + \"_atlas0_\" + i + \".png\");\r\n                    await $promise(task3);\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n        FairyGUI.UIPackage.AddPackage(name, AddressablesMgr.LanLuLoadFunc);\r\n        this.packageCache.push(name);\r\n\r\n        return true;\r\n\r\n    }\r\n\r\n    public clearPackage(name: string) {\r\n        // UIPackage.RemovePackage(\"Assets/Assets/UI/\" + name);\r\n        FairyGUI.UIPackage.RemovePackage(name);\r\n\r\n        let path = \"Assets/Assets/UI/\" + name + \"_fui.bytes\";\r\n        let obj: UnityEngine.TextAsset = AddressablesMgr.Instance.getFGUIAsset(path) as UnityEngine.TextAsset;\r\n        if (obj != null) {\r\n            AddressablesMgr.Instance.releaseTextAsset(obj);\r\n\r\n            // int[] png;\r\n            var len = ViewConst.pngStrDic.get(name);\r\n            if (len) {\r\n                let tx1 = AddressablesMgr.Instance.getFGUIAsset(\"Assets/Assets/UI/\" + name + \"_atlas0.png\") as UnityEngine.Texture;\r\n                AddressablesMgr.Instance.releaseTexture(tx1);\r\n                for (var i = 1; i < len; i++) {\r\n                    let tx2 = AddressablesMgr.Instance.getFGUIAsset(\"Assets/Assets/UI/\" + name + \"_atlas0_\" + i + \".png\") as UnityEngine.Texture;\r\n                    AddressablesMgr.Instance.releaseTexture(tx2);\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n        let index = this.packageCache.indexOf(name);\r\n        this.packageCache.splice(index, 1);\r\n    }\r\n\r\n    /// <summary>\r\n    /// 关闭界面\r\n    /// </summary>\r\n    /// <param name=\"uiId\"></param>\r\n    /// <param name=\"throwWarn\">如果界面不存在，是否抛出警告</param>\r\n    public closeView(uiId: string, throwWarn = true) {\r\n        let lastinfo = this.dic.get(uiId);\r\n        if (lastinfo) {\r\n            if (!lastinfo.isTsView) {\r\n                gzaLog(\"尝试关闭非TS的VIew\", uiId);\r\n                return;\r\n            }\r\n            let view = this.viewCacheDic.get(uiId);\r\n            if (view) {\r\n                if (lastinfo.cache) {\r\n                    view.visible = false;\r\n                    lastinfo.isClose = true;\r\n                    view.onClose();\r\n                    // inst.stackList.Remove(uiId);\r\n                    let index = this.stackList.indexOf(uiId);\r\n                    if (index > -1) {\r\n                        this.stackList.splice(index, 1);\r\n                    }\r\n                    return;\r\n                } else {\r\n                    view.onClose();\r\n                    view.onDestroy();\r\n                    view.Dispose();\r\n                    let index = this.stackList.indexOf(uiId);\r\n                    if (index > -1) {\r\n                        this.stackList.splice(index, 1);\r\n                    }\r\n                    this.dic.delete(uiId);\r\n                    this.viewCacheDic.delete(uiId);\r\n\r\n                }\r\n\r\n                EventCenter.Instance.eventFunc(ViewEvent.VIEW_CLOSE, uiId);\r\n                TSEventCenter.getInstance().event(ViewEvent.VIEW_OPEN, uiId);\r\n            } else {\r\n                Log.logWarning(\"尝试关闭不存在的界面:\" + uiId);\r\n            }\r\n\r\n        }\r\n        else {\r\n            if (throwWarn) {\r\n                Log.logWarning(\"尝试关闭不存在的界面:\" + uiId);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n   *预加载界面\r\n   */\r\n    public async preLoadView(uiId: string, layer: UILayer) {\r\n        let pkgname = ViewConst.pkgNameDic.get(uiId);\r\n        if (pkgname) {\r\n            let task = await this.addPackage(pkgname);\r\n\r\n            let comName = ViewConst.comNameDic.get(uiId);\r\n            if (comName) {\r\n                let info = new UIInfo(uiId, layer, true, null, true);\r\n                this.dic.set(uiId, info);\r\n\r\n                gzaLog(\"preLoadView\", uiId, info.isTsView);\r\n\r\n\r\n                FairyGUI.UIPackage.CreateObjectAsync(pkgname, comName, this.preloadViewOver);\r\n            } else {\r\n                Log.logWarning(\"尝试打开不存在的界面 找不到组件 界面ID:\" + uiId);\r\n            }\r\n        } else {\r\n            Log.logWarning(\"尝试打开不存在的界面 找不到组件 界面ID:\" + uiId);\r\n        }\r\n\r\n    }\r\n\r\n    public async openView(uiId: string, layer: UILayer, isCache: boolean = false, args1: any = null) {\r\n        let lastinfo: UIInfo = this.dic.get(uiId);\r\n        if (lastinfo) {\r\n            if (!lastinfo.isTsView) {\r\n                gzaLog(\"尝试打开非TS的VIew\", uiId);\r\n                return;\r\n            }\r\n\r\n            if (lastinfo.isOpening) {\r\n                gzaLog(\"界面:\" + uiId + \"正在打开中，触发重复打开\");\r\n                return;\r\n            }\r\n\r\n            if (lastinfo.cache) {\r\n                let view = this.viewCacheDic.get(uiId);\r\n                if (view) {\r\n                    view.visible = true;\r\n                    lastinfo.isClose = false;\r\n                    let layerCom = this.layerDic.get(lastinfo.layer);\r\n                    if (layerCom) {\r\n                        layerCom.AddChild(view);\r\n                        this.stackList.push(uiId);\r\n                        lastinfo.args1 = args1;\r\n                        if (ViewConst.scaleDic.has(uiId)) {\r\n                            if (FairyGUI.GRoot.inst.width < FairyGUI.GRoot.inst.height) {\r\n                                //宽是小的，所以是正常的竖屏\r\n                                view.scaleX = 1;\r\n                                view.scaleY = 1;\r\n                                view.SetSize(FairyGUI.GRoot.inst.width, FairyGUI.GRoot.inst.height);\r\n                            } else {\r\n                                //高是小的，因此是横屏，由于我们目前的界面都是竖的，因此需要按比例缩放\r\n                                let percent = FairyGUI.GRoot.inst.height / FairyGUI.GRoot.inst.width;\r\n                                view.scaleX = percent;\r\n                                view.scaleY = percent;\r\n                                view.SetSize(FairyGUI.GRoot.inst.width / percent, FairyGUI.GRoot.inst.height / percent);\r\n                            }\r\n                        }\r\n\r\n\r\n                        view.onOpen(args1);\r\n\r\n                        EventCenter.Instance.eventFunc(ViewEvent.VIEW_OPEN, uiId);\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            let pkgname = ViewConst.pkgNameDic.get(uiId);\r\n            if (pkgname) {\r\n                this.setLoading(uiId);\r\n                let task = await this.addPackage(pkgname);\r\n                let comName = ViewConst.comNameDic.get(uiId);\r\n                if (comName) {\r\n                    if (!this.dic.has(uiId)) {\r\n                        let info = new UIInfo(uiId, layer, isCache, args1, true);\r\n                        this.dic.set(uiId, info);\r\n                    }\r\n                    FairyGUI.UIPackage.CreateObjectAsync(pkgname, comName, this.loadViewOver);\r\n                } else {\r\n                    Log.logWarning(\"尝试打开不存在的界面 找不到组件 界面ID:\" + uiId);\r\n                    this.clearLoading(uiId);\r\n                }\r\n            } else {\r\n                Log.logWarning(\"尝试打开不存在的界面 找不到包 界面ID:\" + uiId);\r\n            }\r\n        }\r\n    }\r\n\r\n    public loadViewOver(obj: FairyGUI.GObject) {\r\n        let com = obj.asCom;\r\n        let url = obj.resourceURL;\r\n        let thisobj = UIManager.getInstance();\r\n        let uiId = ViewConst.resURLDic.get(url);\r\n        if (uiId) {\r\n            let info = thisobj.dic.get(uiId)\r\n            if (info) {\r\n                if (!info.isTsView) {\r\n                    gzaLog(\"加载完毕非TS的VIew\", uiId);\r\n                    return;\r\n                }\r\n                if (!info.isOpening) {\r\n                    //该界面已被关闭\r\n                    if (!info.cache) {\r\n                        obj.Dispose();\r\n                    }\r\n                    return;\r\n                }\r\n                info.isOpening = false;\r\n                info.isClose = false;\r\n\r\n                let layer = thisobj.layerDic.get(info.layer);\r\n                if (layer) {\r\n                    layer.AddChild(com);\r\n                    let baseview = com as BaseView;\r\n                    if (baseview == null) {\r\n                        Log.logError(\"没有绑定扩展类，XXXBinder!\");\r\n                        return;\r\n                    }\r\n                    baseview.uiId = uiId;\r\n                    baseview.MakeFullScreen();\r\n\r\n                    thisobj.viewCacheDic.set(uiId, baseview);\r\n\r\n                    if (ViewConst.scaleDic.has(uiId)) {\r\n                        if (FairyGUI.GRoot.inst.width < FairyGUI.GRoot.inst.height) {\r\n                            //宽是小的，所以是正常的竖屏\r\n                            baseview.scaleX = 1;\r\n                            baseview.scaleY = 1;\r\n                            // baseview.x = 0;\r\n                            // baseview.y = 0;\r\n                            baseview.SetSize(FairyGUI.GRoot.inst.width, FairyGUI.GRoot.inst.height);\r\n                        } else {\r\n                            //高是小的，因此是横屏，由于我们目前的界面都是竖的，因此需要按比例缩放\r\n                            let percent = FairyGUI.GRoot.inst.height / FairyGUI.GRoot.inst.width;\r\n                            baseview.scaleX = percent;\r\n                            baseview.scaleY = percent;\r\n                            baseview.SetSize(FairyGUI.GRoot.inst.width / percent, FairyGUI.GRoot.inst.height / percent);\r\n                        }\r\n                    }\r\n\r\n                    baseview.onInit();\r\n                    baseview.onOpen(info.args1);\r\n                    // baseview.SetSize(FairyGUI.GRoot.inst.width, FairyGUI.GRoot.inst.height);\r\n                    thisobj.stackList.push(uiId);\r\n                    EventCenter.Instance.eventFunc(ViewEvent.VIEW_OPEN, uiId);\r\n                    TSEventCenter.getInstance().event(ViewEvent.VIEW_OPEN, uiId);\r\n                    thisobj.clearLoading(uiId);\r\n                }\r\n            }\r\n        } else {\r\n            Log.logWarning(url + \"指定资源URL未注册\");\r\n        }\r\n\r\n    }\r\n\r\n\r\n    //预加载时，不允许界面传参\r\n    public preloadViewOver(obj: FairyGUI.GObject) {\r\n\r\n        let com = obj.asCom;\r\n        let url = obj.resourceURL;\r\n        let thisobj = UIManager.getInstance();\r\n        let uiId = ViewConst.resURLDic.get(url);\r\n        // gzaLog(thisobj,thisobj.dic,this);\r\n        if (uiId) {\r\n            let info = thisobj.dic.get(uiId);\r\n            if (info) {\r\n                if (!info.isTsView) {\r\n                    gzaLog(\"预加载完毕非TS的VIew\", uiId);\r\n                    return;\r\n                }\r\n                info.isOpening = false;\r\n                info.isClose = true;\r\n                // let layer = this.layerDic.get(info.layer);\r\n\r\n                let cacheView = thisobj.viewCacheDic.get(uiId);\r\n                // gzaLog(\"perloadViewOver\", inst.viewCacheDic);\r\n                // let cacheView = inst.viewCacheDic.get(uiId);\r\n                if (cacheView) {\r\n                    gzaLog(\"预加载完毕时，界面已打开：\" + uiId);\r\n                    return;\r\n                }\r\n\r\n                com.visible = false;\r\n\r\n                let baseview = com as BaseView;\r\n                baseview.uiId = uiId;\r\n                baseview.MakeFullScreen();\r\n                baseview.onInit();\r\n                gzaLog(\"预加载完毕 ID：\", uiId, baseview.uiId);\r\n\r\n\r\n                thisobj.viewCacheDic.set(uiId, baseview);\r\n\r\n                EventCenter.Instance.eventFunc(ViewEvent.VIEW_PRELOAD_OVER, uiId);\r\n                TSEventCenter.getInstance().event(ViewEvent.VIEW_PRELOAD_OVER, uiId);\r\n            }\r\n        } else {\r\n            Log.logWarning(url + \"指定资源URL未注册\");\r\n        }\r\n    }\r\n\r\n\r\n}","import { System, Log } from \"csharp\";\r\nimport MainUIBinder from \"../view/MainUIView/MainUIBinder\";\r\nimport { $typeof } from \"puerts\";\r\nimport { MainUIView } from \"../view/MainUIView/MainUIView\";\r\n\r\nexport class ViewConst {\r\n    public static MainUIView_ID: string = \"MainUIView\";\r\n    public static LevelUpDialogView_ID: string = \"LevelUpDialogView\";\r\n    public static MagicChangeDialog_ID: string = \"MagicChangeDialog\";\r\n    public static MagicEditDialog_ID: string = \"MagicEditDialog\";\r\n    public static WeaponLevelUpDialog_ID: string = \"WeaponLevelUpDialog\";\r\n    public static RewardView_ID: string = \"RewardView\";\r\n\r\n\r\n    public static pkgNameDic: Map<string, string> = new Map<string, string>();\r\n    public static comNameDic: Map<string, string> = new Map<string, string>();\r\n    public static resURLDic: Map<string, string> = new Map<string, string>();\r\n    public static pngStrDic: Map<string, number> = new Map<string, number>(); //包名 - 图集PNG的数量\r\n\r\n    public static scaleDic: Map<string, boolean> = new Map();//组件名ID  是否根据横竖屏进行缩放\r\n\r\n    public static init() {\r\n\r\n        ViewConst.pngStrDic.set(\"Loading\", 1);\r\n        ViewConst.initMainUI();\r\n    }\r\n\r\n    private static initMainUI() {\r\n        //==============包名注册（组件名，包名）=======================\r\n        ViewConst.pkgNameDic.set(ViewConst.MainUIView_ID, \"MainUI\");\r\n\r\n        ViewConst.pngStrDic.set(\"MainUI\", 1);\r\n        ViewConst.pngStrDic.set(\"SkillJoy\", 1);\r\n        ///此处是包名，对应包的图集atls0.png 1 2 3 如果该包，没有图集，请不要赋值\r\n\r\n        //===============组件名注册==============\r\n        //一般直接使用组件ID作为组件名的key\r\n        ViewConst.comNameDic.set(ViewConst.MainUIView_ID, ViewConst.MainUIView_ID);\r\n        //===============组件URL注册+================\r\n        ViewConst.resURLDic.set(MainUIView.URL, ViewConst.MainUIView_ID);\r\n        //===============绑定扩展类===================\r\n        MainUIBinder.BindAll();\r\n    }\r\n\r\n}\r\n","/**\r\n * 组件\r\n */\r\nexport abstract class ECSComponent {\r\n  /**\r\n   * 组件的类名 在每个Com里面应该有个静态属性，为该组件的类名， get name要返回该静态属性\r\n   */\r\n  public abstract get name(): string;\r\n  public static ComName: string = \"ECSComponent\";\r\n\r\n  /**\r\n   * 组件的所有者实体 ID\r\n   */\r\n  public abstract entityId: number;\r\n\r\n  recycleToObjectPool() {\r\n    this.entityId = 0;\r\n  }\r\n}\r\n","import { Log, UnityEngine } from \"csharp\";\r\nimport { ObjectPool, ObjectPoolIT } from \"../../ObjectPool\";\r\nimport { ECSComponent } from \"./ECSComponent\";\r\nimport { ECSManager } from \"./ECSManager\";\r\n\r\nexport class ECSEntity implements ObjectPoolIT {\r\n    //gameObject可以在Com持有\r\n\r\n    recycleToObjectPool() {\r\n        this.id = 0;\r\n\r\n        for (let com of this.components.values()) {\r\n            ECSManager.getInstance().removeCom(com);\r\n            ObjectPool.recover(com.name, com);\r\n        }\r\n\r\n        this.components.clear();\r\n\r\n    }\r\n\r\n    public id: number;\r\n    //ECS一般不会把Entity作为容器，但是在此处存储Component 减少manager储存的复杂度\r\n    public readonly components: Map<string, ECSComponent> = new Map();\r\n\r\n    public active:boolean = true;//是否处于激活状态\r\n\r\n    public getCom(type: any) {\r\n        return this.components.get(type.ComName);\r\n    }\r\n    public getComByName(name: string) {\r\n        return this.components.get(name);\r\n    }\r\n\r\n    /**\r\n     * @param type 类型\r\n     */\r\n    public addCom(type: any): any {\r\n        if (this.components.has(type.ComName)) {\r\n            Log.logError(\"该实体已拥有此组件:\", type.ComName);\r\n            return;\r\n        }\r\n\r\n        let com: ECSComponent = ObjectPool.getObjectByClass(type.ComName, type);\r\n        com.entityId = this.id;\r\n        this.components.set(com.name, com);\r\n        ECSManager.getInstance().addCom(com);\r\n        return com;\r\n    }\r\n\r\n    public removeCom(type: any) {\r\n        let com = this.components.get(type.ComName);\r\n        if (com) {\r\n            ECSManager.getInstance().removeCom(com);\r\n            ObjectPool.recover(type.ComName, com);\r\n            this.components.delete(com.name);\r\n        }\r\n    }\r\n\r\n\r\n    public hasCom(comName: string) {\r\n        return this.components.has(comName);\r\n    }\r\n\r\n\r\n}\r\n","import { Log } from \"csharp\";\r\nimport { ObjectPool } from \"../../ObjectPool\";\r\nimport { Sigleton } from \"../../Sigleton\";\r\nimport { TimerTS } from \"../../TimerTS\";\r\nimport { ECSComponent } from \"./ECSComponent\";\r\nimport { ECSEntity } from \"./ECSEntity\";\r\nimport { ECSSystem } from \"./ECSSystem\";\r\nimport { gzaLog } from \"../../../utils/LogTS\";\r\n\r\n\r\nexport class ECSManager extends Sigleton {\r\n    static getInstance(): ECSManager {\r\n        return super.getInstance(ECSManager);\r\n    }\r\n\r\n    public uid: number = 1;\r\n    public systems: Map<string, ECSSystem>;\r\n    public entitys: Map<number, ECSEntity>;\r\n\r\n    private runningSystems: Map<string, ECSSystem>;\r\n\r\n    //所有System都需要在此注册\r\n    register() {\r\n        // this.systems.set(RoleSystem.SystemName, new RoleSystem);\r\n    }\r\n\r\n    initInstance() {\r\n        this.entitys = new Map();\r\n        this.systems = new Map();\r\n        this.runningSystems = new Map();\r\n        this.uid = 1;\r\n        TimerTS.getInstance().loop(this, this.update);\r\n\r\n        this.register();\r\n\r\n    }\r\n\r\n    public update(dt: number) {\r\n        this.runningSystems.forEach(value => {\r\n            value.update(dt);\r\n        });\r\n    }\r\n\r\n    public getEntity(uid: number): ECSEntity {\r\n        return this.entitys.get(uid);\r\n    }\r\n\r\n    public getSystem(type: any): ECSSystem {\r\n        return this.systems.get(type.SystemName);\r\n    }\r\n\r\n    public getUid(): number {\r\n        return this.uid++;\r\n    }\r\n\r\n\r\n    public getSystemByName(name: string): ECSSystem {\r\n        return this.systems.get(name);\r\n    }\r\n\r\n    public createEntity(): ECSEntity {\r\n        let ent: ECSEntity = ObjectPool.getObjectByClass(\"ECSEntity\", ECSEntity);\r\n        ent.id = this.uid++;\r\n\r\n        // Log.gzaLog(\"createEntity\", ent.id);\r\n        this.entitys.set(ent.id, ent);\r\n        return ent;\r\n    }\r\n\r\n    public recoverEntity(ent: ECSEntity) {\r\n        let id = ent.id;\r\n        ObjectPool.recover(\"ECSEntity\", ent);\r\n        this.entitys.delete(id);\r\n    }\r\n\r\n    //添加组件时，要为监听该组件的system添加索引 能来到这里，说明这个实体还没绑定过这个组件\r\n    public addCom(com: ECSComponent) {\r\n        let entity = this.entitys.get(com.entityId);\r\n\r\n        if (entity) {\r\n            for (let value of this.systems.values()) {\r\n                //只有当实体拥有该system所需要的全部组件时，才激活对应系统\r\n                let canActvie = true;\r\n\r\n                for (let i = 0; i < value.bindTypes.length; i++) {\r\n                    // gzaLog(value.name,com.entityId,value.bindTypes[i], entity.hasCom(value.name));\r\n                    if (!entity.hasCom(value.bindTypes[i])) {\r\n                        canActvie = false;\r\n                        continue;\r\n                    }\r\n                }\r\n\r\n                if (canActvie) {\r\n                    if (!value.entitys.has(com.entityId)) {\r\n                        value.entitys.set(com.entityId, true);\r\n                        value.onWatchEntity(com.entityId);\r\n                        if (!this.runningSystems.has(value.name)) {\r\n                            this.runningSystems.set(value.name, value);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n\r\n    //删除组件时，要把组件从对应system的索引移除\r\n    public removeCom(com: ECSComponent) {\r\n        let entity = this.entitys.get(com.entityId);\r\n        if (entity) {\r\n            for (let value of this.systems.values()) {\r\n                if (!value.entitys.has(com.entityId)) {\r\n                    continue;\r\n                }\r\n\r\n                //缺少任何一个，都需要把它从系统干掉\r\n                if (value.bindTypes.indexOf(com.name) != -1) {\r\n                    // gzaLog(\"从系统中移除\", com.name, com.entityId, value.name);\r\n                    value.entitys.delete(com.entityId);\r\n                    if (value.entitys.size <= 0) {\r\n                        this.runningSystems.delete(value.name);\r\n                    }\r\n                }\r\n\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n}\r\n","import { EventCenter, Log, System, TSEvent } from \"csharp\";\r\nimport { Sigleton } from \"../core/Sigleton\";\r\nimport { UIManager } from \"../core/UIManager\";\r\n\r\nexport class TSEventCenter extends Sigleton {\r\n    static getInstance(): TSEventCenter {\r\n        return super.getInstance(TSEventCenter);\r\n    }\r\n\r\n    initInstance() {\r\n        let inst: EventCenter = EventCenter.Instance;\r\n        inst.bind(TSEvent.CLOSE_VIEW, this, this.closeView);\r\n        inst.bind(TSEvent.PERLOAD_VIEW, this, this.perloadView);\r\n        inst.bind(TSEvent.OPEN_VIEW, this, this.openView);\r\n    }\r\n\r\n    private map: Map<string, any[]> = new Map();\r\n\r\n    public bind(name: string, thisobj: any, func: Function) {\r\n        let arr = this.map.get(name);\r\n        if (arr) {\r\n            let len = arr.length;\r\n            for (let i = 0; i < len; i++) {\r\n                if (arr[i][0] == func && arr[i][1] == thisobj) {\r\n                    Log.logWarning(\"重复注册事件\", name);\r\n                    return;\r\n                }\r\n            }\r\n        } else {\r\n            this.map.set(name, []);\r\n            arr = this.map.get(name);\r\n        }\r\n        arr.push([func, thisobj]);\r\n    }\r\n\r\n\r\n    public unbind(name: string, thisobj: any) {\r\n        let arr = this.map.get(name);\r\n        if (arr) {\r\n            let len = arr.length;\r\n            for (let i = len - 1; i >= 0; i--) {\r\n                if (arr[i][1] == thisobj) {\r\n                    arr.splice(i, 1);\r\n                }\r\n            }\r\n        }\r\n        if (arr && arr.length == 0) {\r\n            this.map.delete(name);\r\n        }\r\n    }\r\n\r\n\r\n    public event(name: string, ...data: any[]) {\r\n        let arr = this.map.get(name);\r\n        if (arr) {\r\n            for (let i = arr.length - 1; i >= 0; i--) {\r\n                let f: Function = arr[i][0];\r\n                f.apply(arr[i][1], data);\r\n            }\r\n        }\r\n    }\r\n\r\n    public closeView(obj: System.Object, args: System.Array$1<System.Object>) {\r\n        let uiid2: any = args.get_Item(0);\r\n        UIManager.getInstance().closeView(uiid2);\r\n    }\r\n\r\n    public perloadView(obj: System.Object, args: System.Array$1<System.Object>) {\r\n        let uiid: any = args.get_Item(0);\r\n        let obj2: any = args.get_Item(1);\r\n        UIManager.getInstance().preLoadView(uiid, obj2);\r\n    }\r\n\r\n    public openView(obj: System.Object, args: System.Array$1<System.Object>) {\r\n        let uiid2: any = args.get_Item(0);\r\n        let obj2: any = args.get_Item(1);\r\n        let iscache: any = args.get_Item(2);\r\n        let args1: any;\r\n        if (args.Length > 3)\r\n            args1 = args.get_Item(3);\r\n        UIManager.getInstance().openView(uiid2, obj2, iscache, args1);\r\n    }\r\n\r\n}","export enum ViewEvent {\r\n    VIEW_CLOSE = \"VIEW_CLOSE\",\r\n    VIEW_OPEN = \"VIEW_OPEN\",\r\n    VIEW_PRELOAD_OVER = \"VIEW_PRELOAD_OVER\",\r\n}","import { UnityEngine } from \"csharp\";\r\nimport { ECSComponent } from \"../../core/ecs/base/ECSComponent\";\r\n\r\n\r\nexport class RoleCom extends ECSComponent {\r\n    public get name(): string {\r\n        return RoleCom.ComName;\r\n    }\r\n    public static ComName: string = \"RoleCom\";\r\n    /**\r\n     * 组件的所有者实体 ID\r\n     */\r\n    public entityId = 0;\r\n\r\n    public roleId: number = 0;//角色ID\r\n    public modelId: number = 0;//模型ID\r\n    \r\n    recycleToObjectPool() {\r\n        super.recycleToObjectPool();\r\n    }\r\n\r\n\r\n\r\n}","import { UnityEngine } from \"csharp\";\r\nimport { ECSComponent } from \"../../core/ecs/base/ECSComponent\";\r\n\r\n\r\nexport class VoCom extends ECSComponent {\r\n    public get name(): string {\r\n        return VoCom.ComName;\r\n    }\r\n    public static ComName: string = \"VoCom\";\r\n    /**\r\n     * 组件的所有者实体 ID\r\n     */\r\n    public entityId = 0;\r\n\r\n    public gameObject: UnityEngine.GameObject;//持有的角色对象\r\n    public ani: UnityEngine.Animator;//持有的动画\r\n    // public state:number = 0;// 1表示处于攻击\r\n\r\n    public isMove:boolean = false;\r\n\r\n\r\n    recycleToObjectPool() {\r\n        super.recycleToObjectPool();\r\n        this.gameObject = null;\r\n        this.ani = null;\r\n    }\r\n\r\n}","import { EventCenter, Log, Timer, TSMain, UnityEngine } from \"csharp\";\r\nimport { ECSManager } from \"../core/ecs/base/ECSManager\";\r\nimport { RoleCom } from \"./Com/RoleCom\";\r\nimport { Sigleton } from \"../core/Sigleton\";\r\nimport { VoCom } from \"./Com/VoCom\";\r\n\r\nexport class World extends Sigleton {\r\n  static getInstance(): World {\r\n    return super.getInstance(World);\r\n  }\r\n\r\n  public ani: UnityEngine.Animator;\r\n  public roleEId: number = 0;\r\n  public role: UnityEngine.GameObject;\r\n\r\n  public nowInCube: number = 0;\r\n\r\n  public async init() {\r\n    //创建实体\r\n    let entity = ECSManager.getInstance().createEntity();\r\n    this.roleEId = entity.id;\r\n\r\n    //为实体添加组件\r\n    let com: RoleCom = entity.addCom(RoleCom);\r\n    let vocom = entity.addCom(VoCom) as VoCom;\r\n\r\n    //修改组件内容\r\n    vocom.ani = this.ani;\r\n    vocom.gameObject = this.role;\r\n\r\n    //获取组件并修改组件内容\r\n    let en = ECSManager.getInstance().getEntity(this.roleEId);\r\n    let vo = en.getCom(VoCom) as VoCom;\r\n    vo.isMove = false;\r\n  }\r\n}\r\n","import { Log } from \"csharp\";\r\n\r\nlet isDebug = true;\r\nif (isDebug)\r\n    Log.setDeBug();\r\nexport let gzaLog = (...data: any[]) => {\r\n    if (!isDebug) {\r\n        return;\r\n    }\r\n    Log.log(...data);\r\n}\r\n\r\nexport let errLog = (...data: any[]) => {\r\n    if (!isDebug) {\r\n        return;\r\n    }\r\n    Log.logError(...data);\r\n}","import { FairyGUI } from \"csharp\";\nimport { MainUIView } from \"./MainUIView\";\n\nexport default class MainUIBinder\n{\n    public static BindAll():void\n    {\n        FairyGUI.UIObjectFactory.SetPackageItemExtension(MainUIView.URL, () => { return new MainUIView(); });\n    }\n}","import { FairyGUI, Log, UnityEngine } from \"csharp\";\r\nimport { BaseView } from \"../../core/BaseView\";\r\nimport { EventCenter } from \"csharp\";\r\n\r\nexport class MainUIView extends BaseView {\r\n\r\n    // public toFight: FairyGUI.GButton;\r\n    // public backMain: FairyGUI.GButton;\r\n    public btn_upLevel: FairyGUI.GLoader;\r\n    public loader_2: FairyGUI.GLoader;\r\n    public loader_1: FairyGUI.GLoader;\r\n    public progressBar: FairyGUI.GProgressBar;\r\n    public txt_percent: FairyGUI.GTextField;\r\n    public txt_1: FairyGUI.GTextField;\r\n    public txt_2: FairyGUI.GTextField;\r\n    public txt_level: FairyGUI.GTextField;\r\n    // public levelGroup: FairyGUI.GGroup;\r\n    public levelUpClick: FairyGUI.GObject;\r\n    public btn_clear: FairyGUI.GButton;\r\n    public img_levelUp: FairyGUI.GComponent;\r\n    public static URL: string = \"ui://mbhw74n8hzlo0\";\r\n\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    public static createInstance(): MainUIView {\r\n        return <MainUIView>(FairyGUI.UIPackage.CreateObject(\"MainUI\", \"MainUIView\"));\r\n    }\r\n\r\n    public onInit() {\r\n        this.levelUpClick = this.GetChild(\"levelUpClick\");\r\n        this.loader_1 = <FairyGUI.GLoader>(this.GetChild(\"loader_1\"));\r\n        this.loader_2 = <FairyGUI.GLoader>(this.GetChild(\"loader_2\"));\r\n        this.progressBar = <FairyGUI.GProgressBar>(this.GetChild(\"progressBar\"));\r\n        this.btn_upLevel = <FairyGUI.GLoader>(this.GetChild(\"btn_upLevel\"));\r\n        this.txt_1 = <FairyGUI.GTextField>(this.GetChild(\"txt_1\"));\r\n        this.txt_2 = <FairyGUI.GTextField>(this.GetChild(\"txt_2\"));\r\n        this.txt_level = <FairyGUI.GTextField>(this.GetChild(\"txt_level\"));\r\n        this.txt_percent = <FairyGUI.GTextField>(this.GetChild(\"txt_percent\"));\r\n        this.btn_clear = <FairyGUI.GButton>(this.GetChild(\"btn_clear\"));\r\n        this.img_levelUp = <FairyGUI.GComponent>(this.GetChild(\"img_levelUp\"));\r\n    }\r\n\r\n    public onOpen(args1: any) {\r\n        super.onOpen(args1);\r\n\r\n        let ins: EventCenter = EventCenter.Instance;\r\n\r\n    }\r\n\r\n\r\n\r\n\r\n    public onClose() {\r\n        super.onClose();\r\n\r\n        this.levelUpClick.onClick.Clear();\r\n        this.btn_clear.onClick.Clear();\r\n        this.img_levelUp.onClick.Clear();\r\n\r\n    }\r\n\r\n    public onDestroy() {\r\n        super.onDestroy();\r\n    }\r\n}","import { AddressablesMgr, GameStart, Log, Timer, TSMain, UnityEngine } from \"csharp\";\r\nimport { ViewConst } from \"../core/ViewConst\";\r\nimport { MainUIView } from \"./MainUIView/MainUIView\";\r\nimport { UILayer, UIManager } from \"../core/UIManager\";\r\nimport { TSEventCenter } from \"../event/TSEventCenter\";\r\nimport { TimerTS } from \"../core/TimerTS\";\r\nimport { ViewEvent } from \"../event/ViewEvent\";\r\nimport { ECSManager } from \"../core/ecs/base/ECSManager\";\r\nimport { World } from \"../fight/World\";\r\n\r\n\r\n\r\nexport let __cacheDic: Map<string, any> = new Map();\r\nfunction initTS() {\r\n    //初始化界面定义\r\n    ViewConst.init();\r\n    let event = TSEventCenter.getInstance();\r\n    let tsUIMgr = UIManager.getInstance();\r\n    let timer = TimerTS.getInstance();\r\n    let ecs = ECSManager.getInstance();\r\n\r\n    let loa = new loading();\r\n    loa.loadingConfig();\r\n}\r\n\r\nclass loading {\r\n\r\n    public async loadingConfig() {\r\n\r\n        let view = GameStart.UI_GameStartView.gameStartView;\r\n        view.m_txt.text = \"加载游戏配置中...\";\r\n\r\n\r\n        this.loadingConfigOver();\r\n    }\r\n\r\n    //加载界面\r\n    public async loadingConfigOver() {\r\n        let view = GameStart.UI_GameStartView.gameStartView;\r\n        view.m_pb.value += 16;\r\n\r\n        view.m_txt.text = \"加载主界面中...\";\r\n        await UIManager.getInstance().addPackage(\"FloatFont\");\r\n        await UIManager.getInstance().addPackage(\"Public\");\r\n\r\n        //加载界面\r\n        let tsUIMgr = UIManager.getInstance();\r\n        tsUIMgr.preLoadView(ViewConst.MainUIView_ID, UILayer.Main);\r\n\r\n        let event = TSEventCenter.getInstance();\r\n        event.bind(ViewEvent.VIEW_PRELOAD_OVER, this, this.loadingScene);\r\n        \r\n\r\n\r\n\r\n    }\r\n\r\n    public async loadingScene() {\r\n        let view = GameStart.UI_GameStartView.gameStartView;\r\n        view.m_txt.text = \"加载游戏场景中...\";\r\n        view.m_pb.value += 16;\r\n        let model = new UnityEngine.SceneManagement.LoadSceneParameters(UnityEngine.SceneManagement.LoadSceneMode.Additive);\r\n        UnityEngine.SceneManagement.SceneManager.LoadScene(1, model);\r\n        view.m_pb.value += 16;\r\n\r\n        TimerTS.getInstance().once(this, this.loadingSceneOver, 0.1)\r\n\r\n    }\r\n\r\n\r\n    public async loadingSceneOver() {\r\n\r\n        let view = GameStart.UI_GameStartView.gameStartView;\r\n        view.m_pb.value += 16;\r\n        view.m_txt.text = \"加载世界中...\";\r\n        \r\n        World.getInstance().init();\r\n\r\n        this.loadingViewOver();\r\n    }\r\n\r\n    public loadingViewOver() {\r\n        TSEventCenter.getInstance().unbind(ViewEvent.VIEW_PRELOAD_OVER, this);\r\n\r\n        //加载完毕后销毁加载界面\r\n        let view = GameStart.UI_GameStartView.gameStartView;\r\n        view.m_pb.value += 16;\r\n\r\n        this.loadingOver();\r\n    }\r\n\r\n    public loadingOver() {\r\n        let view = GameStart.UI_GameStartView.gameStartView;\r\n\r\n        view.m_btn.visible = true;\r\n        view.m_pb.visible = false;\r\n        view.m_btn.onClick.Add(() => { this.enterMain() });\r\n        view.m_txt.text = \"点击进入游戏\";\r\n\r\n    }\r\n\r\n    public enterMain() {\r\n        let view = GameStart.UI_GameStartView.gameStartView;\r\n        UIManager.getInstance().openView(ViewConst.MainUIView_ID, UILayer.Main);\r\n\r\n        view.parent.RemoveChild(view);\r\n        GameStart.UI_GameStartView.gameStartView = null;\r\n    }\r\n}\r\n\r\n\r\ninitTS();\r\n\r\n\r\n","module.exports = require(\"csharp\");","module.exports = require(\"puerts\");"],"sourceRoot":""}